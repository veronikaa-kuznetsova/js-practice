(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(const r of e)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function i(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerPolicy&&(r.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?r.credentials="include":e.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(e){if(e.ep)return;e.ep=!0;const r=i(e);fetch(e.href,r)}})();document.addEventListener("DOMContentLoaded",()=>{const d=document.getElementById("form"),s=document.getElementById("image"),i=document.querySelector(".preview"),n=document.getElementById("textarea"),e=document.getElementById("readonly");d.addEventListener("submit",t=>{t.preventDefault(),alert("The form is sent!")});function r(){if(s.files&&s.files[0]){const t=s.files[0],o=new FileReader;o.onload=a=>{var l;typeof((l=a.target)==null?void 0:l.result)=="string"&&(localStorage.setItem("imageData",a.target.result),i.src=a.target.result,f("imageData",a.target.result))},o.onerror=a=>{console.error("File reading error:",a)},o.readAsDataURL(t)}else console.log("File not found")}function c(){const t=localStorage.getItem("imageData");t&&(i.src=t)}function u(){sessionStorage.setItem("textAreaValue",n.value),sessionStorage.setItem("textAreaHeight",n.style.height),sessionStorage.setItem("textAreaWidth",n.style.width),f("textAreaValue",n.value)}function h(){const t=sessionStorage.getItem("textAreaValue"),o=sessionStorage.getItem("textAreaHeight"),a=sessionStorage.getItem("textAreaWidth");t&&o&&a&&(n.value=t,n.style.height=o,n.style.width=a)}let m;function g(){clearTimeout(m);const t=new Date().toLocaleString();e.value=`latest update: ${t}`,m=setTimeout(g,3e5)}function f(t,o){new BroadcastChannel("sync-form-data").postMessage({key:t,value:o})}function p(){const t=new BroadcastChannel("sync-form-data");t.onmessage=o=>{const{key:a,value:l}=o.data;switch(a){case"imageData":i.src=l;break;case"textAreaValue":n.value=l;break}}}s.addEventListener("change",r),n.addEventListener("input",u),window.addEventListener("beforeunload",()=>{u()}),c(),h(),g(),p()});
